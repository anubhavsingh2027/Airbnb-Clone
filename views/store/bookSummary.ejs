<%- include('../partials/head') %>
<style>
  @media print {
    @page {
      size: A4;
      margin: 0.5cm;
    }
    body {
      background: #fff !important;
      padding: 40px !important;
      color: #111 !important;
      transform: scale(0.95);
      transform-origin: top left;
    }
    * {
      page-break-inside: avoid !important;
    }
    img {
      max-width: 100% !important;
      max-height: 250px !important;
      object-fit: cover !important;
      page-break-inside: avoid !important;
    }
    .no-print {
      display: none !important;
    }
    .print-only {
      display: block !important;
    }
    .p-6, .p-4 {
      padding: 0.5rem !important;
    }
    .space-y-6, .space-y-4 {
      margin-top: 0.25rem !important;
      margin-bottom: 0.25rem !important;
    }
    .text-lg, .text-2xl {
      font-size: 1rem !important;
    }
    .bg-gradient-to-r {
      background: linear-gradient(to right, #f472b6, #ef4444) !important;
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }
    .shadow-lg {
      box-shadow: none !important;
    }
    .rounded-2xl {
      border: 1px solid #f472b6 !important;
    }
    .print-only .fixed {
      position: fixed !important;
    }
  }

  .animate-success {
    animation: successAnimation 0.5s ease-out;
  }
  @keyframes successAnimation {
    0% { transform: scale(0.8); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }
  .btn-fancy {
    transition: all 0.3s ease;
    background-size: 200% auto;
  }
  .btn-fancy:hover {
    background-position: right center;
    transform: translateY(-2px);
  }
</style>
</head>
<body class="bg-gray-50 min-h-screen font-sans text-gray-800">

  <!-- Navbar -->
  <nav class="bg-white shadow-md py-4 mb-8 no-print">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center">
        <img src="/image/airbnbLogo.png" alt="Airbnb logo" class="h-8">
        <div class="text-sm text-gray-500">
          Booking Reference:
          <span class="font-semibold text-gray-900">
            #<%= (home._id).toString().slice(-8).toUpperCase() %>
          </span>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-10">

    <div class="bg-white shadow-lg rounded-2xl overflow-hidden">

      <!-- Property Header -->
      <div class="relative h-48 bg-gradient-to-r from-pink-500 to-red-500">
        <img src="<%=home.photo %>" class="w-full h-full object-cover mix-blend-overlay opacity-50">
        <div class="absolute bottom-0 left-0 right-0 p-6 text-white">
          <h1 class="text-2xl font-bold mb-2"><%=home.housename %></h1>
          <div class="flex items-center space-x-4">
            <p class="flex items-center">
              <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 12.414a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/>
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/>
              </svg>
              <%=home.location%>
            </p>
            <p class="flex items-center">
              <svg class="w-4 h-4 mr-1 text-yellow-300" fill="currentColor" viewBox="0 0 20 20">
                <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
              </svg>
              <%=home.rating %>
            </p>
          </div>
        </div>
      </div>

      <!-- Booking Details -->
      <div class="p-6 space-y-6">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

          <!-- Stay Details -->
          <div class="space-y-4">
            <h2 class="text-lg font-semibold text-gray-900">Stay Details</h2>
            <div class="bg-pink-50 rounded-lg p-4 space-y-3">
              <div class="flex justify-between">
                <span class="text-gray-600">Check-in</span>
                <span class="font-medium"><%= order.checkIn %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Check-out</span>
                <span class="font-medium"><%= order.checkOut %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Nights</span>
                <span class="font-medium"><%= order.numberOfNights %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Guests</span>
                <span class="font-medium"><%= order.guests %></span>
              </div>
            </div>
          </div>

          <!-- Guest Details -->
          <div class="space-y-4">
            <h2 class="text-lg font-semibold text-gray-900">Guest Details</h2>
            <div class="bg-pink-50 rounded-lg p-4 space-y-3">
              <div class="flex justify-between">
                <span class="text-gray-600">Name</span>
                <span class="font-medium"><%= user.firstName %> <%= user.lastName %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Age</span>
                <span class="font-medium"><%= order.age %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Phone</span>
                <span class="font-medium"><%= order.phone %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Aadhar No </span>
                <span class="font-medium"><%=order.aadharNo  %></span>
              </div>
              <div class="flex justify-between">
                <span class="text-gray-600">Special Requests</span>
                <span class="font-medium"><%= order.specialRequests %></span>
              </div>
            </div>
          </div>
        </div>

        <!-- Price Breakdown -->
        <div class="mt-6">
          <h2 class="text-lg font-semibold text-gray-900 mb-4">Price Details</h2>
          <div class="bg-pink-50 rounded-lg p-4 space-y-3">
            <div class="flex justify-between">
              <span class="text-gray-600">Room Charge</span>
              <span class="font-medium">₹<%= order.roomCharge %></span>
            </div>
            <div class="flex justify-between">
              <span class="text-gray-600">Cleaning Fee</span>
              <span class="font-medium">₹<%= order.cleaningFee %></span>
            </div>
            <div class="h-px bg-pink-200 my-2"></div>
            <div class="flex justify-between text-lg font-semibold">
              <span class="text-gray-900">Total Amount</span>
              <span class="text-pink-600">₹<%= order.totalAmount %></span>
            </div>
          </div>
        </div>

        <!-- Actions -->
        <div class="flex flex-col sm:flex-row justify-center gap-4 mt-8 pt-6 border-t border-gray-200 no-print">
          <button onclick="downloadAsPDF()" class="btn-fancy inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-500 to-red-500 hover:from-pink-600 hover:to-red-600 text-white rounded-xl font-bold shadow-lg">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
            </svg>
            Download Booking PDF
          </button>
          <a href="/user/home-list" class="btn-fancy inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-pink-400 to-red-400 hover:from-pink-500 hover:to-red-500 text-white rounded-xl font-bold shadow-lg">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/>
            </svg>
            Return to Homepage
          </a>
        </div>
      </div>
    </div>

    <!-- Print Header and Footer -->
    <div class="print-only" style="display: none;">
      <!-- Header -->
      <div class="fixed top-0 left-0 right-0 bg-gradient-to-r from-pink-500 to-red-500 text-white p-4">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <svg class="w-8 h-8 mr-2" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2L1 12h3v9h6v-6h4v6h6v-9h3L12 2z"/>
            </svg>
            <div>
              <div class="font-bold text-lg">Airbnb Booking Confirmation</div>
              <div class="text-sm opacity-90">Booking ID: #<%= (home._id).toString().slice(-8).toUpperCase() %></div>
            </div>
          </div>
          <div class="text-sm text-right">
            <div>Generated on</div>
            <div class="font-semibold"><%= new Date().toLocaleDateString('en-IN', { day: 'numeric', month: 'long', year: 'numeric' }) %></div>
          </div>
        </div>
      </div>

      <!-- Footer -->
      <div class="fixed bottom-0 left-0 right-0 p-4">
        <div class="border-t border-pink-200 pt-4">
          <div class="flex justify-between text-sm text-gray-500">
            <div>
              <div class="font-semibold text-pink-600">Customer Support</div>
              <div>24/7 helpline: 1800-XXX-XXXX</div>
            </div>
            <div class="text-right">
              <div class="font-semibold text-pink-600">Important Note</div>
              <div>Please present this confirmation at check-in</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Watermark -->
      <div class="fixed inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none -rotate-45">
        <div class="text-[200px] font-black text-pink-500 select-none">
          CONFIRMED
        </div>
      </div>
    </div>
  </main>

  <script>
    function downloadAsPDF() {
      setTimeout(() => {
        window.print();
      }, 100);
    }
  </script>
</body>
</html>
